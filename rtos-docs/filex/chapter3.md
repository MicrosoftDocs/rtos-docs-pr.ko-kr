---
title: 챕터 3 - Azure RTOS FileX의 기능 구성 요소
description: 이 챕터에서는 기능 관점에서 고성능 Azure RTOS FileX 임베디드 파일 시스템에 대해 설명합니다.
author: philmea
ms.author: philmea
ms.date: 05/19/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: a94344a7079e3f0e3e451bc678c369fee543aef6
ms.sourcegitcommit: 60ad844b58639d88830f2660ab0c4ff86b92c10f
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/07/2021
ms.locfileid: "106550170"
---
# <a name="chapter-3---functional-components-of-azure-rtos-filex"></a>챕터 3 - Azure RTOS FileX의 기능 구성 요소

이 챕터에서는 기능 관점에서 고성능 Azure RTOS FileX 임베디드 파일 시스템에 대해 설명합니다.

## <a name="media-description"></a>미디어 설명

FileX는 FAT 파일 시스템 형식을 준수하는 고성능 임베디드 파일 시스템입니다. FileX는 실제 미디어를 논리 섹터의 배열로 봅니다. 이러한 섹터가 기본 실제 미디어에 매핑되는 방법은 ***fx_media_open*** 호출 중에 FileX 미디어에 연결된 I/O 드라이버에 의해 결정됩니다.

### <a name="fat121632-logical-sectors"></a>FAT12/16/32 논리 섹터

미디어 논리 섹터의 정확한 구성은 실제 미디어의 부팅 레코드 내용에 따라 결정됩니다. 그림 1은 미디어 논리 섹터의 일반적인 레이아웃입니다.

FileX 논리 섹터는 미디어의 첫 번째 예약된 섹터를 가리키는 논리 섹터 1에서 시작합니다. 예약된 섹터는 선택 사항이지만 사용할 경우 일반적으로 부팅 코드와 같은 시스템 정보를 포함합니다.

### <a name="fat121632-media-boot-record"></a>FAT12/16/32 미디어 부팅 레코드

미디어의 논리 섹터 보기에서 다른 영역의 정확한 섹터 오프셋은 *미디어 부팅 레코드* 의 콘텐츠에서 파생됩니다. 부팅 레코드의 위치는 일반적으로 섹터 0입니다. 그러나 미디어에 *숨겨진 섹터* 가 있는 경우 부팅 섹터의 오프셋에서 해당 섹터(부팅 섹터 바로 앞에 있음)를 고려해야 합니다. 표 1에서는 미디어의 부팅 레코드 구성 요소를 나열하고 각 구성 요소에 대해 설명합니다.

- **점프 명령** *점프 명령* 필드는 프로세서 점프에 대한 Intel x86 머신 명령을 나타내는 3바이트 필드입니다. 이 필드는 대부분의 상황에서 레거시 필드입니다.

  ![FileX 미디어 논리 섹터 보기](./media/user-guide/filex-media-logical-sector-view.png)

  **그림 1. FileX 미디어 논리 섹터 보기**

- **OEM 이름** *OEM 이름* 필드는 제조업체에서 회사 이름 또는 디바이스 이름을 입력하도록 예약되어 있습니다.
- **섹터당 바이트 수** 미디어 부팅 레코드의 *섹터당 바이트 수* 필드는 미디어의 기본 요소인 각 섹터의 바이트 수를 정의합니다.
- **클러스터당 섹터 수** 미디어 부팅 레코드의 *클러스터당 섹터 수* 필드는 클러스터에 할당되는 섹터 수를 정의합니다. 클러스터는 FAT 호환 파일 시스템의 기본 할당 요소입니다. 모든 파일 정보와 하위 디렉터리는 FAT(파일 할당 테이블)에서 결정한 대로 미디어의 사용 가능한 클러스터에서 할당됩니다.

    **표 1. FileX 미디어 부팅 레코드**
    
    |Offset  |필드  |바이트 수|
    |----------|-----------|------------|
    |0x00|점프 명령(e9, xx, xx, eb, xx, 90)|3|
    |0x03|OEM 이름|8|
    |0x0B|섹터당 바이트 수|2|
    |0x0D|클러스터당 섹터 수|1|
    |0x0E|예약된 섹터 수|2|
    |0x10|FAT 수|1|
    |0x11|루트 디렉터리의 크기|2|
    |0x13|FAT-12 및 FAT-16 섹터 수|2|
    |0x15|미디어 유형|1|
    |0x16|FAT당 섹터 수|2|
    |0x18|트랙당 섹터 수|2|
    |0x1A|헤드 수|2|
    |0x1C|숨겨진 섹터 수|4|
    |0x20|섹터 수 - FAT-32|4|
    |0x24|FAT당 섹터 수(FAT-32)|4|
    |0x2C|루트 디렉터리 클러스터|4|
    |0x3E|시스템 부팅 코드|448
    |0x1FE|0x55AA|2|

- **예약된 섹터** 미디어 부팅 레코드의 *예약된 섹터* 필드는 부팅 레코드와 FAT 영역의 첫 번째 섹터 간에 예약된 섹터 수를 정의합니다. 대부분의 경우 이 항목은 0입니다.
- **FAT 수** 미디어 부팅 레코드의 *FAT 수* 항목은 미디어의 FAT 수를 정의합니다. 미디어에는 항상 하나 이상의 FAT가 있어야 합니다. 추가 FAT는 주(첫 번째) FAT의 중복 복사본에 불과하며 일반적으로 진단 또는 복구 소프트웨어에 사용됩니다.
- **루트 디렉터리 크기** 미디어 부팅 레코드의 *루트 디렉터리 크기* 항목은 미디어 루트 디렉터리의 고정된 항목 수를 정의합니다. 하위 디렉터리와 FAT-32 루트 디렉터리는 미디어의 클러스터에서 할당되기 때문에 이 필드가 적용되지 않습니다.
- **FAT-12 및 FAT-16 섹터 수** 미디어 부팅 레코드의 *섹터 수* 필드에는 미디어의 총 섹터 수가 포함됩니다. 이 필드가 0이면 총 섹터 수는 부팅 레코드의 뒷부분에 있는 *FAT-32 섹터 수* 필드에 포함됩니다.
- **미디어 유형** *미디어 유형* 필드는 디바이스 드라이버에 존재하는 미디어 유형을 식별하는 데 사용됩니다. 레거시 필드입니다.
- **FAT당 섹터 수** 미디어 부팅 레코드의 *FAT당 섹터 수* 필드는 FAT 영역의 각 FAT와 연결된 섹터 수를 포함합니다. FAT 섹터 수는 미디어에 할당할 수 있는 최대 클러스터 수를 고려하여 충분히 커야 합니다.
- **트랙당 섹터 수** 미디어 부팅 레코드의 *트랙당 섹터 수* 필드는 트랙당 섹터 수를 정의합니다. 일반적으로 실제 디스크 형식 미디어와만 관련이 있습니다. FLASH 디바이스는 이 매핑을 사용하지 않습니다.
- **헤드 수** 미디어 부팅 레코드의 *헤드 수* 필드는 미디어의 헤드 수를 정의합니다. 일반적으로 실제 디스크 형식 미디어와만 관련이 있습니다. FLASH 디바이스는 이 매핑을 사용하지 않습니다.
- **숨겨진 섹터** 미디어 부팅 레코드의 *숨겨진 섹터* 필드는 부팅 레코드 이전의 섹터 수를 정의합니다. 이 필드는 **FX_MEDIA** 제어 블록에서 유지 관리되며 FileX가 수행하는 모든 읽기 및 쓰기 요청의 FileX I/O 드라이버를 고려해야 합니다.
- **FAT-32 섹터 수** 미디어 부팅 레코드의 *섹터 수* 필드는 2바이트 *섹터 수* 필드가 0인 경우에만 유효합니다. 이 경우 이 4바이트 필드는 미디어의 섹터 수를 포함합니다.
- **FAT당 섹터 수(FAT-32)** *FAT당 섹터 수(FAT-32)* 필드는 FAT-32 형식에서만 유효하며, 미디어의 각 FAT에 할당되는 섹터 수를 포함합니다.
- **루트 디렉터리 클러스터** *루트 디렉터리 클러스터* 필드는 FAT-32 형식에서만 유효하며 루트 디렉터리의 시작 클러스터 번호를 포함합니다.
- **시스템 부팅 코드** *시스템 부팅 코드* 필드는 일부 부팅 코드를 저장하는 영역입니다. 오늘날 대부분의 디바이스에서 이 필드는 레거시 필드입니다.
- **서명 0x55AA** *서명* 필드는 부팅 레코드를 식별하는 데 사용되는 데이터 패턴입니다. 이 필드가 없으면 부팅 레코드가 유효하지 않습니다.

### <a name="exfat"></a>exFAT

FAT32의 최대 파일 크기는 4GB이며, 이 크기는 HD 멀티미디어 파일의 광범위한 도입을 제한합니다. 기본적으로 FAT32는 스토리지 미디어를 32GB까지 지원합니다. 플래시 및 SD 카드 용량이 점점 늘어나고 있기 때문에 대용량 볼륨 관리의 측면에서 FAT32의 효율성이 떨어지고 있습니다. exFAT는 이러한 제한을 극복할 수 있도록 설계되었습니다. exFAT는 약 10억 기가바이트에 달하는 최대 1엑사바이트(EB)를 지원합니다. exFAT와 FAT32의 또 다른 주요 차이점으로 exFAT는 비트맵을 사용하여 볼륨의 사용 가능한 공간을 관리하며, 따라서 exFAT는 파일에 데이터를 쓸 때 사용 가능한 공간을 보다 효율적으로 찾을 수 있습니다. 연속 클러스터에 저장된 파일의 경우 exFAT는 FAT 체인까지 내려가서 모든 클러스터를 찾을 필요가 없기 때문에 대량의 파일에 액세스할 때 효율성이 더 높습니다. 32GB를 초과하는 플래시 스토리지 및 SD 카드에는 exFAT가 필요합니다.

### <a name="exfat-logical-sectors"></a>exFAT 논리 섹터

그림 2는 exFAT 미디어 논리 섹터의 일반적인 레이아웃입니다. exFAT에서는 부팅 블록 및 FAT 영역이 시스템 영역에 속합니다. 나머지 클러스터는 사용자 영역입니다. 필수는 아니지만 exFAT 표준에 따르면 할당 비트맵이 사용자 영역의 시작 부분에 있고 그 뒤에 Up-case 테이블과 루트 디렉터리가 있는 것이 좋습니다.

### <a name="exfat-media-boot-record"></a>exFAT 미디어 부팅 레코드

exFAT 미디어 부팅 레코드의 콘텐츠는 FAT12/16/32의 콘텐츠와 다릅니다. 표 2에 자세히 나와 있습니다. 혼동을 방지하기 위해, FAT12/16/32의 다양한 미디어 매개 변수를 포함하는 0x0B와 0x40 사이의 영역은 exFAT에서 *예약된* 것으로 표시됩니다. 이 예약된 영역은 미디어 부팅 레코드를 잘못 해석하는 일이 없도록 0으로 프로그래밍해야 합니다.

![exFAT 논리 섹터](./media/user-guide/exfat-logical-sectors.png)

**그림 2. exFAT 논리 섹터**

- **점프 명령** *점프 명령* 필드는 프로세서 점프에 대한 Intel x86 머신 명령을 나타내는 3바이트 필드입니다. 이 필드는 대부분의 상황에서 레거시 필드입니다.

    **표2. exFAT 미디어 부팅 레코드**

    |Offset  |필드  |바이트 수|
    |----------|-----------|------------|
    |0x00|점프 명령|3|
    |0x03|파일 시스템 이름|8|
    |0x0B|예약됨|53|
    |0x40|파티션 오프셋|8|
    |0x48|볼륨 길이|8|
    |0x50|FAT 오프셋|4|
    |0x54|FAT 길이|4|
    |0x58|클러스터 힙 오프셋|4|
    |0x5C|클러스터 수|4|
    |0x60|루트 디렉터리의 첫 번째 클러스터|4|
    |0x64|볼륨 일련 번호|4|
    |0x68|파일 시스템 수정 버전|2|
    |0x6A|볼륨 플래그|2|
    |0x6C|섹터 시프트당 바이트 수|1|
    |0x6D|클러스터 시프트당 섹터 수|1|
    |0x6E|FAT 수|1|
    |0x6F|드라이브 선택|1|
    |0x70|사용률(%)|7|
    |0x71|예약됨|1|
    |0x78|부팅 코드|390|
    |0x1FE|부팅 서명|2|

- **파일 시스템 이름** exFAT의 경우 *파일 시스템 이름* 필드는 "EXFAT"여야 하고 그 뒤에 후행 공백 3개가 있어야 합니다.
- **예약됨** *예약됨* 필드의 콘텐츠는 0이어야 합니다. 이 영역은 FAT12/16/32의 부팅 레코드와 겹칩니다. 이 영역을 0으로 설정하면 파일 시스템에서 이 볼륨을 잘못 해석하는 일이 없습니다.
- **파티션 오프셋** *파티션 오프셋* 필드는 이 파티션의 시작을 나타냅니다.
- **볼륨 길이** *볼륨 길이* 필드는 이 파티션의 크기를 섹터 수로 정의합니다.
- **FAT 오프셋** *FAT 오프셋* 필드는 이 파티션의 시작 부분을 기준으로 이 파티션에 대한 FAT 테이블의 시작 섹터 번호를 정의합니다.
- **FAT 길이** *FAT 길이* 필드는 FAT 테이블의 크기를 섹터 수로 정의합니다.
- **클러스터 힙 오프셋** *클러스터 힙 오프셋* 필드는 파티션의 시작 부분을 기준으로 클러스터 힙의 시작 섹터 번호를 정의합니다. 클러스터 힙은 디렉터리 정보 및 파일 데이터가 저장되는 영역입니다.
- **클러스터 수** *클러스터 수* 필드는 이 파티션에 포함되는 클러스터 수를 정의합니다.
- **루트 디렉터리의 첫 번째 클러스터** *루트 디렉터리의 첫 번째 클러스터* 필드는 루트 디렉터리의 시작 위치를 정의합니다. 할당 비트맵과 up-case 테이블의 바로 뒤에 있는 것이 좋습니다.
- **볼륨 일련 번호** *볼륨 일련 번호* 필드는 이 파티션의 일련 번호를 정의합니다.
- **파일 시스템 수정 버전** *파일 시스템 수정 버전* 필드는 exFAT의 주 버전 및 부 버전을 정의합니다.
- **볼륨 플래그** *볼륨 플래그* 필드에는 이 볼륨의 상태를 나타내는 플래그가 포함됩니다.
- **섹터 시프트당 바이트 수** *섹터 시프트당 바이트 수* 필드는 섹터당 바이트 수를 log2(n) 형식으로 정의합니다. 여기서 n은 섹터당 바이트 수입니다. 예를 들어 SD 카드에서 섹터 크기는 512바이트입니다. 따라서 이 필드는 9입니다(log2(512) = 9).
- **클러스터 시프트당 섹터 수** *클러스터 시프트당 섹터 수* 필드는 클러스터의 섹터 수를 log2(n) 형식으로 정의합니다. 여기서 n은 클러스터당 섹터 수입니다.
- **FAT 수** *FAT 수* 필드는 이 파티션의 FAT 테이블 수를 정의합니다. exFAT의 경우 FAT 테이블 하나에 값 1을 권장합니다.
- **드라이브 선택** *드라이브 선택* 필드는 확장된 INT 13h 드라이브 번호를 정의합니다.
- **사용률(%)** *사용률(%)* 필드는 클러스터 힙이 할당되는 클러스터 비율을 정의합니다. 유효한 값은 0 ~ 100입니다.
- **예약됨** 이 필드는 나중에 사용하기 위해 예약되었습니다.
- **부팅 코드** *부팅 코드* 필드는 일부 부팅 코드를 저장하는 영역입니다. 오늘날 대부분의 디바이스에서 이 필드는 레거시 필드입니다.
- **서명 0x55AA** *부팅 서명* 필드는 부팅 레코드를 식별하는 데 사용되는 데이터 패턴입니다. 이 필드가 없으면 부팅 레코드가 유효하지 않습니다.

### <a name="file-allocation-table-fat"></a>FAT(파일 할당 테이블)

*FAT(파일 할당 테이블)* 는 미디어의 예약된 섹터 뒤에서 시작합니다. FAT 영역은 기본적으로 해당 클러스터가 할당되었는지 아니면 하위 디렉터리 또는 파일을 구성하는 클러스터 체인의 일부인지 결정하는 12비트, 16비트 또는 32비트 항목의 배열입니다. 각 FAT 항목의 크기는 표시해야 하는 클러스터 수에 따라 결정됩니다. 클러스터 수(총 섹터 수를 클러스터당 섹터 수로 나눈 값에서 파생됨)가 4086보다 작거나 같으면 12비트 FAT 항목이 사용됩니다. 총 클러스터 수가 4086보다 크고 65525보다 작으면 16비트 FAT 항목이 사용됩니다. 총 클러스터 수가 65525보다 크거나 같으면 32비트 FAT 또는 exFAT가 사용됩니다.

FAT12/16/32의 경우 FAT 테이블은 클러스터 체인을 유지할 뿐 아니라 클러스터 할당 정보(클러스터의 가용성)도 제공합니다. exFAT에서 클러스터 할당 정보는 할당 비트맵 디렉터리 항목을 통해 유지 관리합니다. 각 파티션에는 자체 할당 비트맵이 있습니다. 비트맵의 크기는 사용 가능한 모든 클러스터를 수용하기에 충분합니다. 클러스터를 할당할 수 있는 경우 할당 비트맵에서 해당 비트가 0으로 설정됩니다. 그렇지 않으면 비트가 1로 설정됩니다. 연속된 클러스터를 점유하는 파일의 경우에는 모든 클러스터를 추적할 수 있도록 exFAT에서 FAT 체인을 요구하지 않습니다. 그러나 연속된 클러스터를 점유하지 않는 파일의 경우에도 FAT 체인을 유지해야 합니다.

### <a name="fat-entry-contents"></a>FAT 항목 콘텐츠

FAT 테이블의 처음 두 항목은 사용되지 않으며 일반적으로 다음과 같은 콘텐츠를 포함합니다.

|FAT 항목 |12비트 FAT|16비트 FAT|32비트 FAT| exFAT|
|----------|-----------|------------|-------|------|
|Entry 0|0x0F0|0x00F0|0x000000F0|0xF8FFFFFF|
|Entry 1|0xFFF|0xFFFF|0x0FFFFFFF|0xFFFFFFFF|

FAT 항목 번호 2는 미디어의 데이터 영역에 있는 첫 번째 클러스터를 나타냅니다. 각 클러스터 항목의 콘텐츠에 따라 클러스터가 사용 가능한 상태인지 아니면 파일 또는 하위 디렉터리에 할당된 클러스터 연결 목록에 포함되어 있는지 결정됩니다. 클러스터 항목에 유효한 다른 클러스터 항목이 포함되어 있으면 클러스터가 할당되었고 해당 값은 클러스터 체인에 할당된 다음 클러스터를 가리킵니다.

가능한 클러스터 항목은 다음과 같이 정의됩니다.

|의미|12비트 FAT|16비트 FAT|32비트 FAT| exFAT|
|----------|-----------|------------|-------|------|
|사용 가능한 클러스터|0x000|0x0000|0x00000000|0x00000000|
|사용되지 않음|0x001|0x0001|0x00000001|0x00000001|
|예약됨|0xFF0-FF6|0xFFF0-FFF6|0x0FFFFFF0-6|0xFFFFFFF6에 ClusterCounter +2|
|불량 클러스터|0xFF7|0xFFF7|0x0FFFFFF7|0xFFFFFFF7|
|예약됨| - | - | - | 0xFFFFFFF8-E|
|마지막 클러스터| 0xFF8-FFF| 0xFFF8-FFFF| 0x0FFFFFF8-F| 0xFFFFFFFF|
|클러스터 링크| 0x002-0xFEF| 0x0002-FFEF| 0x2-0x0FFFFFEF | 0x2 - ClusterCount +1|

할당된 클러스터 체인의 마지막 클러스터에는 위에 정의된 마지막 클러스터 값이 포함됩니다. 첫 번째 클러스터 번호는 파일 또는 하위 디렉터리의 디렉터리 항목에서 찾을 수 있습니다.

### <a name="internal-logical-cache"></a>내부 논리 캐시

FileX는 열려 있는 미디어마다 *가장 최근에 사용한* 논리 섹터 캐시를 유지합니다. 논리 섹터 캐시의 최대 크기는 상수 **FX_MAX_SECTOR_CACHE** 에 의해 정의되며 **_fx_api.h_** 에 있습니다. 내부 논리 섹터 캐시의 크기를 결정하는 첫 번째 요소입니다.

논리 섹터 캐시의 크기를 결정하는 다른 요소는 애플리케이션에서 ***fx_media_open** _ 호출에 제공하는 메모리 양입니다. 적어도 논리 섹터 하나를 충분히 수용할 수 있는 메모리가 필요합니다. _ *FX_MAX_SECTOR_CACHE**보다 많은 논리 섹터가 필요한 경우에는 **_fx_api.h_** 에서 상수를 변경하고 전체 FileX 라이브러리를 다시 빌드해야 합니다.

> [!IMPORTANT]
> *FileX에서 열려 있는 각 미디어는 열린 호출 중에 제공되는 메모리에 따라 캐시 크기가 다를 수 있습니다.*

### <a name="write-protect"></a>쓰기 보호

FileX는 미디어에 대한 쓰기 보호를 동적으로 설정하는 기능을 애플리케이션 드라이버에 제공합니다. 쓰기 보호가 필요한 경우 드라이버는 연결된 FX_MEDIA 구조의 *fx_media_driver_write_protect* 필드를 FX_TRUE로 설정합니다. 이렇게 설정하면 파일에 쓰기 위한 열기 시도뿐 아니라 애플리케이션에서 미디어를 수정하려는 모든 시도가 거부됩니다. 드라이버에서 이 필드를 지워서 쓰기 보호를 해제할 수도 있습니다.

### <a name="free-sector-update"></a>사용 가능한 섹터 업데이트

FileX는 섹터가 더 이상 사용되지 않을 때 애플리케이션 드라이버에 알리는 메커니즘을 제공합니다. FileX에서 사용하는 모든 논리 섹터를 관리하는 FLASH 메모리 관리자에게 특히 유용한 메커니즘입니다.

사용 가능한 섹터 알림이 필요한 경우 애플리케이션 드라이버는 연결된 FX_MEDIA 구조의 *fx_media_driver_free_sector_update* 필드를 FX_TRUE로 설정합니다. 이 할당은 일반적으로 드라이버 초기화 중에 수행됩니다.

이 필드를 설정하면 FileX는 하나 이상의 연속 섹터를 사용할 수 있게 되면 그 사실을 알리는 **FX_DRIVER_RELEASE_SECTORS** 드라이버 호출을 수행합니다.

### <a name="media-control-block-fx_media"></a>미디어 제어 블록 FX_MEDIA

FileX에서 열려 있는 각 미디어의 특징은 미디어 제어 블록에 포함됩니다. 이 구조는 ***fx_api.h*** 파일에 정의되어 있습니다.

미디어 제어 블록은 메모리의 어디에나 위치할 수 있지만 제어 블록을 모든 함수의 범위 밖에 정의하여 전역 구조로 만드는 것이 가장 일반적입니다.

제어 블록을 다른 영역에서 두려면 모든 동적 할당 메모리와 마찬가지로 조금 더 주의가 필요합니다. 제어 블록이 C 함수 내에 할당된 경우 이것과 연결된 메모리는 호출 스레드 스택의 일부입니다.

> [!WARNING]
>*제어 블록에는 로컬 스토리지를 사용하지 않는 것이 일반적입니다. 함수가 반환된 후, 모든 로컬 변수 스택 공간이 사용 여부에 관계없이 해제되기 때문입니다.*

## <a name="fat121632-directory-description"></a>**FAT12/16/32 디렉터리 설명**

FileX는 8.3 및 Windows LFN(긴 파일 이름) 이름 형식을 모두 지원합니다. 이름 외에도 각 디렉터리 항목에는 항목의 특성, 마지막으로 수정한 시간 및 날짜, 시작 클러스터 인덱스 및 항목의 크기(바이트)가 포함됩니다. 표 3에는 FileX 8.3 디렉터리 항목의 내용과 크기가 설명되어 있습니다.

- **디렉터리 이름**

    FileX는 1 ~ 255자의 파일 이름을 지원합니다. 표준 8자 파일 이름은 미디어의 단일 디렉터리 항목에 표시됩니다. 디렉터리 이름 필드에서 왼쪽 맞춤되며 공백으로 채워집니다. 또한 이름을 구성하는 ASCII 문자는 항상 대문자입니다.

    LFN(긴 파일 이름)은 연속 디렉터리 항목을 사용하여 역순으로 표시되며, 바로 뒤에 8.3 표준 파일 이름이 옵니다. 생성된 8.3 이름에는 이름과 관련된 모든 의미 있는 디렉터리 정보가 포함되어 있습니다. 표 4에서는 긴 파일 이름 정보를 보관하는 데 사용되는 디렉터리 항목의 내용을 보여주고, 표 5에서는 총 4개의 디렉터리 항목이 필요한 39자 LFN의 예를 보여줍니다.

> [!IMPORTANT]
> ***fx_api.h** 에 정의된 상수 **FX_MAX_LONG_NAME_LEN** 은 FileX에서 지원하는 최대 길이를 포함합니다.*

- **디렉터리 파일 이름 확장명**

    표준 8.3 파일 이름의 경우 FileX는 3자 길이의 선택적 *디렉터리 파일 이름 확장명* 을 지원합니다. 8자 파일 이름과 마찬가지로, 파일 이름 확장명은 디렉터리 파일 이름 확장명 필드에서 왼쪽 맞춤되고 공백으로 채워지며, 항상 대문자로 표시됩니다.

    **표 3. FileX 8.3 디렉터리 항목**

    |Offset|필드|바이트 수|
    |------------|-----------|------------|
    |0x00|디렉터리 항목 이름|8|
    |0x08|디렉터리 확장명|3|
    |0x0B|특성|1|
    |0x0C|NT(긴 파일 이름 형식으로 도입되었으며 NT [항상 0]에 사용하도록 예약됨)|1|
    |0x0D|만든 시간(밀리초)(긴 파일 이름 형식으로 도입되었으며 파일을 만든 시간(밀리초)을 나타냄)|1|
    |0x0E|만든 시간(시간 및 분)(긴 파일 이름 형식으로 도입되었으며 파일을 만든 시간 및 분을 나타냄)|2|
    |0x10|만든 날짜(긴 파일 이름 형식으로 도입되었으며 파일을 만든 날짜를 나타냄)|2|
    |0x12|마지막으로 액세스한 날짜(긴 파일 이름 형식으로 도입되었으며 파일에 마지막으로 액세스한 날짜를 나타냄)|2|
    |0x14|시작 클러스터(대문자 16비트 FAT-32에만 해당)|2|
    |0x16|수정한 시간|2|
    |0x18|수정한 날짜|2|
    |0x1A|시작 클러스터(소문자 16비트 FAT-32 또는 FAT-12 또는 FAT-16)|2|
    |0x1C|파일 크기|4|


- **디렉터리 특성**

    1바이트 *디렉터리 특성* 필드 항목에는 디렉터리 항목의 다양한 속성을 지정하는 일련의 비트가 포함됩니다. 디렉터리 특성 정의는 다음과 같습니다.

    |특성 비트|의미|
    |------------|-----------|
    |0x01|항목이 읽기 전용입니다.|
    |0x02|항목이 숨겨져 있습니다.|
    |0x04|항목이 시스템 항목입니다.|
    |0x08|항목이 볼륨 레이블입니다.|
    |0x10|항목이 디렉터리입니다.|
    |0x20|항목이 수정되었습니다.|

    모든 특성 비트는 함께 사용할 수 없으므로 한 번에 둘 이상의 특성 비트가 설정된 것일 수 있습니다.

- **디렉터리 시간**

    2바이트 *디렉터리 시간* 필드에는 지정된 디렉터리 항목을 마지막으로 변경한 시간, 분, 초가 포함됩니다. 비트 15부터 11에는 시간, 비트 10부터 5에는 분, 비트 4부터 0에는 0.5초가 포함됩니다. 실제 초를 이 필드에 기록하기 전에 2로 나뉩니다.

- **디렉터리 날짜**

    2바이트 *디렉터리 날짜* 필드에는 지정된 디렉터리 항목을 마지막으로 변경한 연(1980년부터 오프셋), 월, 일이 포함됩니다. 비트 15부터 9에는 연도 오프셋, 비트 8부터 5에는 월 오프셋, 비트 4부터 0에는 일이 포함됩니다.

- **디렉터리 시작 클러스터**

    이 필드는 FAT-12 및 FAT-16의 경우 2바이트를 점유합니다. FAT-32의 경우 4바이트를 점유합니다. 이 필드에는 항목(하위 디렉터리 또는 파일)에 할당된 첫 번째 클러스터 번호가 포함됩니다.

    > [!NOTE]
    > *FileX는 초기 클러스터(0과 동일한 시작 클러스터 필드) 없이 새 파일을 만들기 때문에 사용자가 필요에 따라 새로 만든 파일에 대한 연속 클러스터를 할당할 수 있습니다. *

- **디렉터리 파일 크기**

    4바이트 *디렉터리* *파일 크기* 필드에는 파일의 바이트 수가 포함됩니다. 항목이 실제로 하위 디렉터리인 경우 크기 필드는 0입니다.

### <a name="long-file-name-directory"></a>긴 파일 이름 디렉터리

- **서수**

    LFN 항목의 번호를 지정하는 1바이트 *서수* 필드입니다. LFN 항목이 역순으로 배치되기 때문에 단일 LFN을 구성하는 LFN 디렉터리 항목의 서수 값은 1씩 줄어듭니다. 또한 8.3 파일 이름 바로 앞에 있는 LFN의 서수 값은 1이어야 합니다.

    **표 4. 긴 파일 이름 디렉터리 항목**

    | Offset | 필드 | 바이트 수 |
    |------------|-----------|------------|
    | 0x00 | 서수 필드 | 1 |
    | 0x01 | 유니코드 문자 1 | 2 |
    | 0x03 | 유니코드 문자 2 | 2 |
    | 0x05 | 유니코드 문자 3 | 2 |
    | 0x07 | 유니코드 문자 4 | 2 |
    | 0x09 | 유니코드 문자 5 | 2 |
    | 0x0B | LFN 특성 | 1 |
    | 0x0C | LFN 형식(항상 0으로 예약됨) | 1 |
    | 0x0D | LFN 체크섬 | 1 |
    | 0x0E | 유니코드 문자 6 | 2 | 
    | 0x10 | 유니코드 문자 7 | 2 |
    | 0x12 | 유니코드 문자 8 | 2 |
    | 0x14 | 유니코드 문자 9 | 2 |
    | 0x16 | 유니코드 문자 10 | 2 |
    | 0x18 | 유니코드 문자 11 | 2 |
    | 0x1A | LFN 클러스터(사용 안 함 항상 0) | 2 |
    | 0x1C | 유니코드 문자 12 | 2 |
    | 0x1E | 유니코드 문자 13 | 2 |

- **유니코드 문자**

    2바이트 *유니코드 문자* 필드는 다양한 언어의 문자를 지원하도록 설계되었습니다. 표준 ASCII 문자는 유니코드 문자의 첫 번째 바이트에 저장된 ASCII 문자 다음에 공백 문자를 넣어서 표시합니다.

- **LFN 특성**

    1바이트 *LFN 특성* 필드에는 디렉터리 항목을 LFN 디렉터리 항목으로 식별하는 특성이 포함됩니다. 이를 위해서는 읽기 전용, 시스템, 숨김 및 볼륨 특성을 모두 설정해야 합니다.

- **LFN 형식**

    1바이트 *LFN 형식* 필드는 예약되어 있으며 항상 0입니다.

- **LFN 체크섬**

    1바이트 *LFN 체크섬* 필드는 연결된 MSDOS 8.3 파일 이름의 11자 체크섬을 나타냅니다. LFN 항목이 적절한 8.3 파일과 일치하도록 도와주기 위해 이 체크섬은 각 LFN 항목에 저장됩니다.

- **LFN 클러스터**

    2바이트 *LFN 클러스터* 필드는 사용되지 않으며 항상 0입니다.

    **표 5. 39자 LFN을 구성하는 디렉터리 항목**

    |입력|의미|
    |------------|-----------|
    |1|LFN 디렉터리 항목 3|
    |2|LFN 디렉터리 항목 2|
    |3|LFN 디렉터리 항목 1|
    |4|8.3 디렉터리 항목(ttttt~n.xx)|

### <a name="exfat-directory-description"></a>exFAT 디렉터리 설명

exFAT 파일 시스템은 디렉터리 항목과 파일 이름을 다른 방식으로 저장합니다. 디렉터리 항목에는 항목의 특성, 항목이 생성/수정/액세스된 시간에 대한 다양한 타임스탬프가 포함됩니다. 파일 크기 및 시작 클러스터와 같은 기타 정보는 기본 디렉터리 항목 바로 다음에 오는 스트림 확장 디렉터리 항목에 저장됩니다. exFAT는 LFN(긴 파일 이름) 이름 형식만 지원합니다. 이 정보는 표 2처럼 스트림 확장 디렉터리 항목 바로 다음에 오는 파일 이름 디렉터리 항목에 저장됩니다.

### <a name="exfat-file-directory-entry"></a>exFAT 파일 디렉터리 항목

다음 표와 단락에는 exFAT 파일 디렉터리 항목 및 해당 콘텐츠에 대한 설명이 포함되어 있습니다.

- **항목 유형**

    항목 유형 필드는 이 항목의 유형을 나타냅니다. 파일 디렉터리 항목의 경우 이 필드는 0x85여야 합니다.

- **보조 항목 수**

    *보조 항목 수* 필드는 기본 항목 바로 다음에 오는 보조 항목의 수를 나타냅니다. 파일 디렉터리 항목과 연결된 보조 항목에는 스트림 확장 디렉터리 항목 1개와 하나 이상의 파일 이름 디렉터리 항목이 포함됩니다.

    **표 6. exFAT 파일 디렉터리 항목**

    |Offset|필드|바이트 수|
    |----|-----------|-|
    |0x00|항목 유형|1|
    |0x01|보조 항목|1|
    |0x02|체크섬|2|
    |0x04|파일 특성|2|
    |0x06|예약 1|2|
    |0x08|생성된 타임스탬프|4|
    |0x0C|마지막 수정 시간 타임스탬프|4|
    |0x10|마지막으로 액세스한 시간 타임스탬프|4|
    |0x14|10ms 증분 만들기|1|
    |0x15|마지막 수정 시간 10ms 증분|1|
    |0x16|UTC 오프셋 만들기|1|
    |0x17|마지막으로 수정한 시간 UTC 오프셋|1|
    |0x18|마지막으로 액세스한 시간 UTC 오프셋|1|
    |0x19|예약 2|7|

- **Checksum**

    *체크섬* 필드에는 디렉터리 항목 세트의 모든 항목에 대한 체크섬 값(파일 디렉터리 항목 및 해당 보조 항목)이 포함됩니다.

- **파일 특성**

    1바이트 특성 필드 항목에는 디렉터리 항목의 다양한 속성을 지정하는 일련의 비트가 포함됩니다. 특성 비트 정의는 대부분 FAT 12/16/32와 동일합니다. 디렉터리 특성 정의는 다음과 같습니다.

    |특성 비트|의미|
    |------------|-----------|
    |0x01| 항목이 읽기 전용|
    |0x02|항목이 숨겨져 있음|
    |0x04|항목이 시스템 항목|
    |0x08|항목이 예약됨|
    |0x10|항목이 디렉터리|
    |0x20|항목이 수정됨|
    |그 외의 모든 비트|예약됨|

- **Reserved1**

    이 필드는 0이어야 합니다.

- **생성된 타임스탬프**

    *타임스탬프 만들기* 필드는 *10ms 증분 만들기* 필드의 정보를 조합하여 파일 또는 디렉터리가 생성된 현지 날짜와 시간을 설명합니다.

- **마지막 수정 시간 타임스탬프**

    *마지막 수정 시간 타임스탬프* 필드는 *마지막 수정 시간 10ms 증분* 필드의 정보를 조합하여 파일 또는 디렉터리가 마지막으로 수정된 현지 날짜와 시간을 설명합니다. 타임스탬프에 대한 아래 참고 사항을 확인하세요.

- **마지막으로 액세스한 시간 타임스탬프**

    *마지막으로 액세스한 시간 타임스탬프* 필드는 파일 또는 디렉터리에 마지막으로 액세스한 현지 날짜와 시간을 설명합니다. 타임스탬프에 대한 아래 참고 사항을 확인하세요.

- **10ms 증분 만들기**

    *10ms 증분 만들기* 필드는 *타임스탬프 만들기* 필드의 정보를 조합하여 파일 또는 디렉터리가 생성된 현지 날짜와 시간을 설명합니다. 타임스탬프에 대한 아래 참고 사항을 확인하세요.

- **마지막 수정 시간 10ms 증분**

    *마지막 수정 시간 10ms 증분* 필드는 *마지막 수정 시간 타임스탬프* 필드의 정보를 조합하여 파일 또는 디렉터리가 마지막으로 수정된 현지 날짜와 시간을 설명합니다. 타임스탬프에 대한 아래 참고 사항을 확인하세요.

- **UTC 오프셋 만들기**

    *UTC 오프셋 만들기* 필드는 파일 또는 디렉터리를 만든 시점의 현지 시간과 UTC 시간의 차이를 설명합니다. 타임스탬프에 대한 아래 참고 사항을 확인하세요.

- **마지막으로 수정한 시간 UTC 오프셋**

    *마지막으로 수정한 시간 UTC 오프셋* 필드는 파일 또는 디렉터리를 마지막으로 수정한 시점의 현지 시간과 UTC 시간의 차이를 설명합니다. 타임스탬프에 대한 아래 참고 사항을 확인하세요.

- **마지막으로 액세스한 시간 UTC 오프셋**

    *마지막으로 액세스한 시간 UTC 오프셋* 필드는 파일 또는 디렉터리에 마지막으로 액세스한 시점의 현지 시간과 UTC 시간의 차이를 설명합니다. 타임스탬프에 대한 아래 참고 사항을 확인하세요.

- **Reserved2**

    이 필드는 0이어야 합니다.

### <a name="notes-on-timestamps"></a>타임스탬프에 대한 참고 사항

- **타임스탬프 항목** 타임스탬프 필드는 다음과 같이 해석됩니다.

- **10ms 증분 필드** 10ms 증분 필드의 값을 조절하여 타임스탬프 값을 세밀하게 조정할 수 있습니다. 유효한 값은 0(0ms) ~ 199(1990ms)입니다.

     ![10ms 증분 필드](./media/user-guide/10ms-increment-fields.png)

- **UTC 오프셋 필드**

     ![UTC 오프셋 필드](./media/user-guide/utc-offset-field.png)

- **오프셋 값**

    이 부호 있는 7비트 정수는 UTC 시간의 오프셋을 15분 단위로 나타냅니다.

- **Valid**

    오프셋 필드의 값이 유효한지 여부를 나타냅니다. 0은 오프셋 값 필드의 값이 올바르지 않다는 뜻입니다. 1은 값이 유효하다는 뜻입니다.

### <a name="stream-extension-directory-entry"></a>스트림 확장 디렉터리 항목

다음 표에는 스트림 확장 디렉터리 항목 및 해당 콘텐츠에 대한 설명이 포함되어 있습니다.

**표 7. 스트림 확장 디렉터리 항목**

|Offset|필드| 바이트 수|
|------------|-----------|-------|
|0x00|항목 유형|1|
|0x01|플래그|1|
|0x02|예약 1|1|
|0x03|이름 길이|1|
|0x04|이름 해시|2|
|0x06|예약 2|2|
|0x08|유효한 데이터 길이|8|
|0x10|예약 3|4|
|0x14|첫 번째 클러스터|4|
|0x18|데이터 길이|8|

- **항목 유형**

    *항목 유형* 필드는 이 항목의 유형을 나타냅니다. 스트리밍 확장 디렉터리 항목의 경우 이 필드는 0xC0이어야 합니다.

- **플래그**

    이 필드에는 다양한 속성을 지정하는 일련의 비트가 포함됩니다.
    
    |플래그 비트|의미    |
    |-----------------|-----------|
    |0x01            |이 필드는 클러스터를 할당할 수 있는지 여부를 나타냅니다. 이 필드는 1이어야 합니다.|
    |0x02            |이 필드는 연결된 클러스터가 연속적인지 여부를 나타냅니다. 값 0은 FAT 항목이 유효하고 FileX가 FAT 체인을 따라야 한다는 것을 의미합니다. 값 1은 FAT 항목이 유효하지 않으며 클러스터가 연속적이라는 뜻입니다.|
    |그 외의 모든 비트    |예약되어 있습니다.|

- **예약 1**

    이 필드는 0이어야 합니다.

- **이름 길이**

    *이름 길이* 필드에는 파일 이름 디렉터리 항목에 집합적으로 포함된 유니코드 문자열의 길이가 포함됩니다. 파일 이름 디렉터리 항목은 이 스트림 확장 디렉터리 항목 바로 뒤에 와야 합니다.

- **이름 해시**

    *이름 해시* 필드는 2바이트 항목이며 대문자 파일 이름의 해시 값을 포함합니다. 해시 값을 사용하면 파일/디렉터리 이름 조회 속도가 빨라집니다. 해시 값이 일치하지 않으면 이 항목과 연결된 파일 이름이 일치하지 않습니다.

- **예약 2**

    이 필드는 0이어야 합니다.

- **유효한 데이터 길이**

    *유효한 데이터 길이* 필드는 파일의 유효한 데이터 크기를 나타냅니다.

- **예약 3**

    이 필드는 0이어야 합니다.

- **첫 번째 클러스터**

    *첫 번째 클러스터* 필드에는 데이터 스트림에 있는 첫 번째 클러스터의 인덱스가 포함됩니다.

- **데이터 길이**

    *데이터 길이* 필드에는 할당된 클러스터의 총 바이트 수가 포함됩니다. exFAT는 데이터 클러스터를 미리 할당할 수 있으므로 이 값이 *유효한 데이터 길이* 보다 클 수 있습니다.

### <a name="root-directory"></a>루트 디렉터리

FAT 12 및 16비트 형식에서 *루트 디렉터리* 는 미디어의 모든 FAT 섹터 바로 뒤에 있으며 열려 있는 _ *FX_MEDIA** 제어 블록에서 ***fx_media_root_sector_start** _를 검사하여 찾을 수 있습니다. 루트 디렉터리의 크기는 디렉터리 항목의 수를 기준으로(각각 32바이트) 미디어 부팅 레코드의 해당 항목에 따라 결정됩니다.

FAT-32 및 exFAT의 루트 디렉터리는 사용 가능한 클러스터의 어디에나 위치할 수 있습니다. 루트 디렉터리의 위치와 크기는 미디어를 열 때 부팅 레코드에서 결정됩니다. 미디어를 연 후 ***fx_media_root_sector_start*** 필드를 사용하여 FAT-32 또는 exFAT 루트 디렉터리의 시작 클러스터를 찾을 수 있습니다.

### <a name="subdirectories"></a>하위 디렉터리

FAT 시스템에는 많은 하위 디렉터리가 있습니다. 하위 디렉터리의 이름은 파일 이름과 마찬가지로 디렉터리 항목에 있습니다. 하지만 디렉터리 특성 사양(0x10)은 항목이 하위 디렉터리이며 파일 크기가 항상 0임을 나타내도록 설정됩니다.
그림 3에서는 _*_FILE.TXT_**라는 파일 하나가 들어 있는 새 단일 클러스터 하위 디렉터리 ***SAMPLE.DIR** _의 일반적인 하위 디렉터리 구조를 보여줍니다.
대부분의 경우 하위 디렉터리는 파일 항목과 매우 유사합니다. 첫 번째 클러스터 필드는 연결된 클러스터 목록의 첫 번째 클러스터를 가리킵니다. 하위 디렉터리를 만들 때 처음 두 디렉터리 항목에는 기본 디렉터리, 즉 "." 디렉터리와 ".." 디렉터리가 포함됩니다. "." 디렉터리는 하위 디렉터리 자체를 가리키고, "..." 디렉터리는 이전 또는 부모 디렉터리를 가리킵니다.

### <a name="global-default-path"></a>전역 기본 경로

FileX는 미디어의 전역 기본 경로를 제공합니다. 기본 경로는 전체 경로를 명시적으로 지정하지 않는 모든 파일 또는 디렉터리 서비스에 사용됩니다.

처음에는 전역 기본 디렉터리가 미디어의 루트 디렉터리로 설정됩니다. 애플리케이션에서 ***fx_directory_default_set*** 를 호출하여 변경할 수 있습니다.

미디어의 현재 기본 경로는 ***fx_directory_default_get** _을 호출하여 검사할 수 있습니다. 이 루틴은 _ *FX_MEDIA** 제어 블록 내에 유지되는 기본 경로 문자열에 대한 문자열 포인터를 제공합니다.

### <a name="local-default-path"></a>로컬 기본 경로

FileX는 서로 다른 스레드가 충돌 없이 고유한 경로를 가질 수 있도록 허용하는 스레드별 기본 경로를 제공합니다. **FX_LOCAL_PATH** 구조는 호출 스레드의 로컬 경로를 수정하기 위해 **_fx_directory_local_path_set_ *_ 및 _* _fx_directory_local_path_restore_** 를 호출하는 동안 애플리케이션에서 제공합니다.

로컬 경로가 있는 경우 로컬 경로가 전역 기본 미디어 경로보다 우선 적용됩니다. 로컬 경로가 설정되지 않았거나 ***fx_directory_local_path_clear*** 서비스를 사용하여 로컬 경로를 지운 경우에는 미디어의 전역 기본 경로가 다시 한 번 사용됩니다.

## <a name="file-description"></a>파일 설명

FileX는 3자 확장명이 포함된 표준 8.3자 및 긴 파일 이름을 지원합니다. ASCII 이름 외에도 각 파일 항목에는 항목의 특성, 마지막으로 수정한 시간 및 날짜, 시작 클러스터 인덱스 및 항목의 크기(바이트)가 포함됩니다.

### <a name="file-allocation"></a>파일 할당

FileX는 FAT 형식의 표준 클러스터 할당 스키마를 지원합니다. 또한 FileX는 연속 클러스터의 사전 클러스터 할당을 지원합니다. 이를 위해 각 FileX 파일은 할당된 클러스터 없이 만들어집니다. 클러스터는 후속 쓰기 요청 시 또는 연속 클러스터를 미리 할당하기 위한 ***fx_file_allocate*** 요청 시에 할당됩니다.

그림 4 "FileX FAT-16 파일 예제"에서는 클러스터 101에서 시작하는 두 개의 순차적인 클러스터가 할당되었고, 크기는 26이고, 파일의 첫 번째 데이터 클러스터 번호 101의 데이터가 알파벳인 ***FILE.TXT*** 파일을 보여줍니다.

### <a name="file-access"></a>파일 액세스

FileX 파일은 읽기 액세스를 위해 동시에 여러 번 열 수 있습니다. 그러나 쓰기에는 파일을 한 번만 열 수 있습니다. 파일 액세스를 지원하는 데 사용되는 정보는 ***FX_FILE*** 파일 제어 블록에 포함되어 있습니다.

> [!NOTE]
> *미디어 드라이버에서 쓰기 방지를 동적으로 설정할 수 있습니다. 쓰기 방지가 설정되면 모든 쓰기 요청이 거부되고 파일을 쓰기용으로 열려는 모든 시도가 거부됩니다.*

### <a name="file-layout-in-exfat"></a>exFAT의 파일 레이아웃

exFAT 디자인은 데이터를 연속 클러스터에 저장하면 파일에 대한 FAT 체인을 유지할 필요가 없습니다. 스트림 확장 디렉터리 항목의 *NoFATChain* 비트는 파일의 데이터를 읽을 때 FAT 체인을 사용해야 하는지 여부를 나타냅니다. *NoFATChain* 을 설정하면 FileX는 스트림 확장 디렉터리 항목의 *첫 번째 클러스터* 필드에 지정된 클러스터에서 순차적으로 읽습니다.

반면 *NoFATChain* 설정을 지우면 FAT12/16/32의 FAT 체인과 마찬가지로 FileX는 전체 파일을 트래버스하기 위해 FAT 체인을 따릅니다.

그림 3에서 보여주는 샘플 파일 중 하나는 FAT 체인이 필요 없고 다른 하나는 FAT 체인이 필요합니다.

## <a name="system-information"></a>시스템 정보

FileX 시스템 정보는 열린 미디어 인스턴스를 추적하고 전역 시스템 시간 및 날짜를 유지 관리하는 것으로 구성됩니다.

![인접 클러스터가 있는 파일과 FAT 링크가 필요한 파일의 비교](./media/user-guide/system-information.png)

**그림 3. 인접 클러스터가 있는 파일과 FAT 링크가 필요한 파일의 비교**

기본적으로 시스템 날짜 및 시간은 FileX의 마지막 릴리스 날짜로 설정됩니다. 시스템 날짜와 시간을 정확하게 유지하려면 초기화하는 동안 애플리케이션에서 ***fx_system_time_set** _ 및 _ *_fx_system_date_set_**를 호출해야 합니다.

### <a name="system-date"></a>시스템 날짜

FileX 시스템 날짜는 전역 ***_fx_system_date*** 변수에 유지됩니다. 비트 15부터 9에는 1980년의 연도 오프셋, 비트 8부터 5에는 월 오프셋, 비트 4부터 0에는 일이 포함됩니다. |

### <a name="system-time"></a>시스템 시간

FileX 시스템 날짜는 전역 ***_fx_system_time*** 변수에 유지됩니다. 비트 15부터 11에는 시간, 비트 10부터 5에는 분, 비트 4부터 0에는 0.5초가 포함됩니다.

### <a name="periodic-time-update"></a>주기적인 시간 업데이트

시스템 초기화 중에 FileX는 시스템 날짜 및 시간을 주기적으로 업데이트하는 ThreadX 애플리케이션 타이머를 만듭니다. 시스템 날짜 및 시간을 업데이트하는 속도는 ***_fx_system_initialize*** 함수에서 사용하는 두 개의 상수에 따라 결정됩니다.

상수 **FX_UPDATE_RATE_IN_SECONDS** 및 **FX_UPDATE_RATE_IN_TICKS** 는 동일한 기간을 나타냅니다. 상수 **FX_UPDATE_RATE_IN_TICKS** 는 상수 **FX_UPDATE_RATE_IN_SECONDS** 에 지정된 시간(초)을 나타내는 ThreadX 타이머 틱 수입니다. 상수 **FX_UPDATE_RATE_IN_SECONDS** 는 각 FileX 시간 업데이트 사이의 시간(초)을 지정합니다. 따라서 내부 FileX 시간은 **FX_UPDATE_RATE_IN_SECONDS** 간격으로 증가합니다. 이러한 상수는 **_fx_system_initialize_ *_를 컴파일하는 동안 제공할 수도 있고, 개발자가 FileX 릴리스의 _* _fx_port.h_** 파일에 있는 기본값을 수정할 수도 있습니다.

주기적 FileX 타이머는 파일 시간 타임스탬프에만 사용되는 전역 시스템 날짜 및 시간을 업데이트하는 용도로만 사용됩니다. 타임스탬프가 필요하지 않은 경우에는 **_fx_system_initialize.c_** 를 컴파일할 때 **FX_NO_TIMER** 를 정의하면 FileX 주기적 타이머를 만들 필요가 없습니다.

![FileX FAT-16 파일 예제](./media/user-guide/fat-16-file-example.png)

**그림 4. FileX FAT-16 파일 예제**
